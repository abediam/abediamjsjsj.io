<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø¹Ø´Ù‚</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Vazirmatn', sans-serif; }

        body {
            background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            color: #444;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .game-container {
            position: relative;
            text-align: center;
            width: 100%;
            max-width: 400px;
        }

        /* Ù‡Ø¯Ø± Ùˆ Ù†ÙˆØ¨Øª */
        .turn-box {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            width: 90%;
            margin-left: auto;
            margin-right: auto;
        }

        .turn-box h2 { color: #d6336c; font-size: 1.5rem; margin-bottom: 5px; }
        .turn-box p { font-size: 1.1rem; font-weight: bold; color: #555; }

        /* Ú¯Ø±Ø¯ÙˆÙ†Ù‡ */
        .wheel-wrapper {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        .pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 30px;
            background: #ff4d4d;
            clip-path: polygon(100% 0, 0 0, 50% 100%);
            z-index: 10;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 5px solid rgba(255, 255, 255, 0.6);
            background: conic-gradient(
                #ffcad4 0deg 45deg,
                #fff 45deg 90deg,
                #ffcad4 90deg 135deg,
                #fff 135deg 180deg,
                #ffcad4 180deg 225deg,
                #fff 225deg 270deg,
                #ffcad4 270deg 315deg,
                #fff 315deg 360deg
            );
            position: relative;
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99); /* Ø§ÙÚ©Øª Ú†Ø±Ø®Ø´ Ù†Ø±Ù… */
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        /* Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ú¯Ø±Ø¯ÙˆÙ†Ù‡ */
        .segment-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: 0 0;
            font-size: 14px;
            font-weight: bold;
            color: #d6336c;
            width: 140px; /* Ø´Ø¹Ø§Ø¹ Ø¯Ø§ÛŒØ±Ù‡ */
            text-align: right;
            padding-right: 40px;
            line-height: 0;
        }

        /* Ø¯Ú©Ù…Ù‡ ÙˆØ³Ø· */
        .center-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 5;
            border: 4px solid #f8bbd0;
            user-select: none;
        }
        
        .center-btn:active { transform: translate(-50%, -50%) scale(0.95); }

        /* Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ù†ØªÛŒØ¬Ù‡ */
        .result-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        
        .result-box {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            width: 80%;
            max-width: 350px;
            animation: popUp 0.4s ease;
        }

        @keyframes popUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .result-text { font-size: 1.5rem; color: #d6336c; margin: 15px 0; font-weight: 900; }
        
        .close-btn {
            background: #d6336c;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
        }

    </style>
</head>
<body>

    <div class="game-container">
        <div class="turn-box">
            <h2 id="currentPlayer">Ù†ÙˆØ¨Øª...</h2>
            <p>Ø¨Ø§ÛŒØ¯ Ù„ÛŒØ³ Ø¨Ø²Ù†Ù‡: ğŸ˜ˆ</p>
        </div>

        <div class="wheel-wrapper">
            <div class="pointer"></div>
            <div class="wheel" id="wheel">
                </div>
            <div class="center-btn" onclick="spinWheel()">Ø¨Ú†Ø±Ø®ÙˆÙ†</div>
        </div>
    </div>

    <div class="result-overlay" id="resultModal">
        <div class="result-box">
            <h3>ğŸ‘… ÙˆØ¸ÛŒÙÙ‡ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø´Ù‡!</h3>
            <p id="resultMessage" class="result-text">...</p>
            <button class="close-btn" onclick="closeResult()">Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!</button>
        </div>
    </div>

    <script>
        // Ù„ÛŒØ³Øª Ø§Ø¹Ø¶Ø§ÛŒ Ø¨Ø¯Ù† Ø¨Ø±Ø§ÛŒ Ú¯Ø±Ø¯ÙˆÙ†Ù‡
        const segments = [
            "Ú¯Ø±Ø¯Ù†", "Ù„Ø¨", "Ú¯ÙˆØ´", "Ø´Ú©Ù…", 
            "Ø±Ø§Ù†", "Ú©Ù Ù¾Ø§", "Ú©Ù…Ø±", "Ù¾ÛŒØ´ÙˆÙ†ÛŒ"
        ];
        
        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡
        const wheel = document.getElementById('wheel');
        const currentPlayerEl = document.getElementById('currentPlayer');
        const resultModal = document.getElementById('resultModal');
        const resultMessage = document.getElementById('resultMessage');

        // Ø¯Ø±ÛŒØ§ÙØª Ø¨Ø§Ø²ÛŒÚ©Ù†Ø§Ù† Ø§Ø² Ø­Ø§ÙØ¸Ù‡
        let players = JSON.parse(localStorage.getItem('gamePlayers')) || ["Ø¨Ø§Ø²ÛŒÚ©Ù† Û±", "Ø¨Ø§Ø²ÛŒÚ©Ù† Û²"];
        let turnIndex = 0;
        let currentRotation = 0;
        let isSpinning = false;

        // Ù‚Ø±Ø§Ø± Ø¯Ø§Ø¯Ù† Ù…ØªÙ†â€ŒÙ‡Ø§ Ø±ÙˆÛŒ Ú¯Ø±Ø¯ÙˆÙ†Ù‡
        const segmentAngle = 360 / segments.length;
        segments.forEach((text, index) => {
            const div = document.createElement('div');
            div.className = 'segment-text';
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ø§ÙˆÛŒÙ‡ Ù…ØªÙ†
            const rotate = (index * segmentAngle) + (segmentAngle / 2); // ÙˆØ³Ø· Ù‡Ø± Ù‚Ø§Ú†
            // Ù…Ù†ÙÛŒ 90 Ø¯Ø±Ø¬Ù‡ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ù…ØªÙ† Ø§Ø² Ø³Ù…Øª Ø±Ø§Ø³Øª Ø´Ø±ÙˆØ¹ Ø´ÙˆØ¯ (Ø¯Ø± Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ CSS Ø²Ø§ÙˆÛŒÙ‡ 0 Ø¨Ø§Ù„Ø§Ø³Øª)
            div.style.transform = `rotate(${rotate - 90}deg) translate(50%, -50%)`;
            div.innerText = text;
            wheel.appendChild(div);
        });

        // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØ¨Øª Ø§ÙˆÙ„
        updateTurnDisplay();

        function updateTurnDisplay() {
            currentPlayerEl.innerText = `Ù†ÙˆØ¨Øª: ${players[turnIndex]}`;
        }

        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;

            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú†Ø±Ø®Ø´ ØªØµØ§Ø¯ÙÛŒ (Ø­Ø¯Ø§Ù‚Ù„ 5 Ø¯ÙˆØ± Ú©Ø§Ù…Ù„ + Ù…Ù‚Ø¯Ø§Ø± ØªØµØ§Ø¯ÙÛŒ)
            const randomDegree = Math.floor(Math.random() * 360);
            const extraSpins = 360 * 5; 
            const totalDegree = extraSpins + randomDegree;
            
            // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ú†Ø±Ø®Ø´ ÙØ¹Ù„ÛŒ ØªØ§ Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø¨Ù‡ Ø¹Ù‚Ø¨ Ø¨Ø±Ù†Ú¯Ø±Ø¯Ø¯
            currentRotation += totalDegree; 
            
            wheel.style.transform = `rotate(-${currentRotation}deg)`; // Ù…Ù†ÙÛŒ Ø¨Ø±Ø§ÛŒ Ú†Ø±Ø®Ø´ Ø³Ø§Ø¹ØªÚ¯Ø±Ø¯

            // Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø§ÛŒØ§Ù† Ø§Ù†ÛŒÙ…ÛŒØ´Ù† (4 Ø«Ø§Ù†ÛŒÙ‡)
            setTimeout(() => {
                showResult(currentRotation % 360);
                isSpinning = false;
            }, 4000);
        }

        function showResult(actualDegree) {
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§ÛŒÙ†Ú©Ù‡ Ù¾ÙˆÛŒÙ†ØªØ± Ø±ÙˆÛŒ Ú©Ø¯Ø§Ù… Ù‚Ø§Ú† Ø§Ø³Øª
            // Ù¾ÙˆÛŒÙ†ØªØ± Ø¨Ø§Ù„Ø§Ø³Øª (0 Ø¯Ø±Ø¬Ù‡)ØŒ Ø§Ù…Ø§ Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ú†Ø±Ø®ÛŒØ¯Ù‡.
            const degreePerSegment = 360 / segments.length;
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø¨Ø±Ù†Ø¯Ù‡
            const winningIndex = Math.floor(actualDegree / degreePerSegment); 
            
            // Ú†ÙˆÙ† Ú†Ø±Ø®Ø´ Ù…Ù†ÙÛŒ Ø¨ÙˆØ¯ØŒ ØªØ±ØªÛŒØ¨ Ø¢Ø±Ø§ÛŒÙ‡ Ø¯Ø±Ø³Øª Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
            // Ø§Ú¯Ø± Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø± Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø¨ÙˆØ¯ØŒ Ø¨Ø§ Ù„Ø§Ú¯ ØªØ³Øª Ú©Ù†ÛŒØ¯. Ø§ÛŒÙ†Ø¬Ø§ Ø³Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª.
            // Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ù†Ø­ÙˆÙ‡ Ú†ÛŒÙ†Ø´ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ Ù…Ø¹Ú©ÙˆØ³ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ†Ø¯Ú©Ø³ Ø¨Ø§Ø´Ø¯ Ø§Ù…Ø§ Ø¨Ø±Ø§ÛŒ Ù…ØªÙ† Ù‡Ø§ÛŒ Ø³Ø§Ø¯Ù‡ ÙØ±Ù‚ Ø²ÛŒØ§Ø¯ÛŒ Ù†Ø¯Ø§Ø±Ø¯
            
            // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù…ØªÙ† (Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ø¬Ù‡Øª Ú†Ø±Ø®Ø´ Ùˆ Ù…Ú©Ø§Ù† Ù¾ÙˆÛŒÙ†ØªØ±)
            // ÙØ±Ù…ÙˆÙ„ Ø¯Ù‚ÛŒÙ‚: (ØªØ¹Ø¯Ø§Ø¯ Ø³Ú¯Ù…Ù†Øª - 1) - (Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ ØªÙ‚Ø³ÛŒÙ… Ø¨Ø± Ø¯Ø±Ø¬Ù‡ Ù‡Ø± Ø³Ú¯Ù…Ù†Øª)
            // Ø±ÙˆØ´ Ø³Ø§Ø¯Ù‡â€ŒØªØ±: Ù†Ù…Ø§ÛŒØ´ Ø±Ù†Ø¯ÙˆÙ… ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ Ø²Ø§ÙˆÛŒÙ‡ Ù†Ù‡Ø§ÛŒÛŒ
            
            /* Ø±ÙˆØ´ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ Ø¯Ù‚ÛŒÙ‚ Ø¨Ø±Ø§ÛŒ Ù¾ÙˆÛŒÙ†ØªØ± Ø¨Ø§Ù„Ø§ */
            const normalizedDeg = actualDegree % 360;
            const index = Math.floor(normalizedDeg / degreePerSegment);
            // Ø¢Ø±Ø§ÛŒÙ‡ Ù…Ø§ Ø³Ø§Ø¹ØªÚ¯Ø±Ø¯ Ú†ÛŒØ¯Ù‡ Ø´Ø¯Ù‡ØŒ Ù¾Ø³ Ø¨Ø§ Ú†Ø±Ø®Ø´ Ø³Ø§Ø¹ØªÚ¯Ø±Ø¯ØŒ Ø§ÛŒÙ†Ø¯Ú©Ø³â€ŒÙ‡Ø§ Ø§Ø² Ø¢Ø®Ø± Ø¨Ù‡ Ø§ÙˆÙ„ Ù…ÛŒØ§Ù† Ø²ÛŒØ± Ù¾ÙˆÛŒÙ†ØªØ±
            let finalIndex = (segments.length - 1) - index;
            if (finalIndex < 0) finalIndex = 0;

            const bodyPart = segments[finalIndex];
            const player = players[turnIndex];

            resultMessage.innerHTML = `${player} Ø¨Ø§ÛŒØ¯ <br><span style="font-size:2rem">${bodyPart}</span><br> Ø±Ùˆ Ù„ÛŒØ³ Ø¨Ø²Ù†Ù‡! ğŸ˜‹`;
            resultModal.style.display = 'flex';
        }

        function closeResult() {
            resultModal.style.display = 'none';
            // Ù†ÙˆØ¨Øª Ù†ÙØ± Ø¨Ø¹Ø¯ÛŒ
            turnIndex = (turnIndex + 1) % players.length;
            updateTurnDisplay();
        }
    </script>
</body>
</html>